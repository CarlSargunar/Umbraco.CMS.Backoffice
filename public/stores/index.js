var E=function(n,e){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},E(n,e)};function f(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");E(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function x(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return o}function v(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}function l(n){return typeof n=="function"}function M(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var w=M(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function O(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var m=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,i,o;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=x(a),c=s.next();!c.done;c=s.next()){var p=c.value;p.remove(this)}}catch(u){e={error:u}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else a.remove(this);var d=this.initialTeardown;if(l(d))try{d()}catch(u){o=u instanceof w?u.errors:[u]}var C=this._finalizers;if(C){this._finalizers=null;try{for(var y=x(C),h=y.next();!h.done;h=y.next()){var R=h.value;try{B(R)}catch(u){o=o??[],u instanceof w?o=v(v([],b(o)),b(u.errors)):o.push(u)}}}catch(u){r={error:u}}finally{try{h&&!h.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}}if(o)throw new w(o)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)B(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&O(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&O(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),H=m.EMPTY;function K(n){return n instanceof m||n&&"closed"in n&&l(n.remove)&&l(n.add)&&l(n.unsubscribe)}function B(n){l(n)?n():n.unsubscribe()}var P={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},k={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=k.delegate;return i?.setTimeout?i.setTimeout.apply(i,v([n,e],b(t))):setTimeout.apply(void 0,v([n,e],b(t)))},clearTimeout:function(n){var e=k.delegate;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function z(n){k.setTimeout(function(){throw n})}function F(){}var _=null;function S(n){if(P.useDeprecatedSynchronousErrorHandling){var e=!_;if(e&&(_={errorThrown:!1,error:null}),n(),e){var t=_,r=t.errorThrown,i=t.error;if(_=null,r)throw i}}else n()}var U=function(n){f(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,K(t)&&t.add(r)):r.destination=G,r}return e.create=function(t,r,i){return new D(t,r,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(m),Q=Function.prototype.bind;function j(n,e){return Q.call(n,e)}var L=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){T(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){T(r)}else T(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){T(t)}},n}(),D=function(n){f(e,n);function e(t,r,i){var o=n.call(this)||this,a;if(l(t)||!t)a={next:t??void 0,error:r??void 0,complete:i??void 0};else{var s;o&&P.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=function(){return o.unsubscribe()},a={next:t.next&&j(t.next,s),error:t.error&&j(t.error,s),complete:t.complete&&j(t.complete,s)}):a=t}return o.destination=new L(a),o}return e}(U);function T(n){z(n)}function q(n){throw n}var G={closed:!0,next:F,error:q,complete:F},W=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function X(n){return n}function Z(n){return n.length===0?X:n.length===1?n[0]:function(t){return n.reduce(function(r,i){return i(r)},t)}}var V=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var i=this,o=tt(e)?e:new D(e,t,r);return S(function(){var a=i,s=a.operator,c=a.source;o.add(s?s.call(o,c):c?i._subscribe(o):i._trySubscribe(o))}),o},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=$(t),new t(function(i,o){var a=new D({next:function(s){try{e(s)}catch(c){o(c),a.unsubscribe()}},error:o,complete:i});r.subscribe(a)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[W]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Z(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=$(e),new e(function(r,i){var o;t.subscribe(function(a){return o=a},function(a){return i(a)},function(){return r(o)})})},n.create=function(e){return new n(e)},n}();function $(n){var e;return(e=n??P.Promise)!==null&&e!==void 0?e:Promise}function N(n){return n&&l(n.next)&&l(n.error)&&l(n.complete)}function tt(n){return n&&n instanceof U||N(n)&&K(n)}function et(n){return l(n?.lift)}function rt(n){return function(e){if(et(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function nt(n,e,t,r,i){return new it(n,e,t,r,i)}var it=function(n){f(e,n);function e(t,r,i,o,a,s){var c=n.call(this,t)||this;return c.onFinalize=a,c.shouldUnsubscribe=s,c._next=r?function(p){try{r(p)}catch(d){t.error(d)}}:n.prototype._next,c._error=o?function(p){try{o(p)}catch(d){t.error(d)}finally{this.unsubscribe()}}:n.prototype._error,c._complete=i?function(){try{i()}catch(p){t.error(p)}finally{this.unsubscribe()}}:n.prototype._complete,c}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(U),ot=M(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),J=function(n){f(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new Y(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new ot},e.prototype.next=function(t){var r=this;S(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=x(r.currentObservers),s=a.next();!s.done;s=a.next()){var c=s.value;c.next(t)}}catch(p){i={error:p}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var r=this;S(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var i=r.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;S(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,i=this,o=i.hasError,a=i.isStopped,s=i.observers;return o||a?H:(this.currentObservers=null,s.push(t),new m(function(){r.currentObservers=null,O(s,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,i=r.hasError,o=r.thrownError,a=r.isStopped;i?t.error(o):a&&t.complete()},e.prototype.asObservable=function(){var t=new V;return t.source=this,t},e.create=function(t,r){return new Y(t,r)},e}(V),Y=function(n){f(e,n);function e(t,r){var i=n.call(this)||this;return i.destination=t,i.source=r,i}return e.prototype.next=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,t)},e.prototype.error=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&i!==void 0?i:H},e}(J),A=function(n){f(e,n);function e(t){var r=n.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=n.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,i=t.thrownError,o=t._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(J);function g(n,e){return rt(function(t,r){var i=0;t.subscribe(nt(r,function(o){r.next(n.call(e,o,i++))}))})}class I{constructor(e){this._data=[],this._data=e}getById(e){return this._data.find(t=>t.id===e)}getByKey(e){return this._data.find(t=>t.key===e)}getAll(){return this._data}save(e){return e.forEach(t=>{const r=this._data.findIndex(i=>i.id===t.id);r!==-1?this._data[r]=t:this._data.push(t)}),e}}const at=[{id:1245,key:"dt-1",name:"Text",propertyEditorUIAlias:"Umb.PropertyEditorUI.Text"},{id:1244,key:"dt-2",name:"Textarea",propertyEditorUIAlias:"Umb.PropertyEditorUI.Textarea"},{id:1246,key:"dt-3",name:"My JS Property Editor",propertyEditorUIAlias:"My.PropertyEditorUI.Custom"},{id:1247,key:"dt-4",name:"Context Example",propertyEditorUIAlias:"Umb.PropertyEditorUI.ContextExample"},{id:1248,key:"dt-5",name:"Content Picker (DataType)",propertyEditorUIAlias:"Umb.PropertyEditorUI.ContentPicker"}];class st extends I{constructor(){super(at)}}const ct=new st;class ut{constructor(){this._dataTypes=new A([]),this.dataTypes=this._dataTypes.asObservable()}getById(e){return fetch(`/umbraco/backoffice/data-type/${e}`).then(t=>t.json()).then(t=>{this._updateStore(t)}),this.dataTypes.pipe(g(t=>t.find(r=>r.id===e)||null))}getByKey(e){return fetch(`/umbraco/backoffice/data-type/by-key/${e}`).then(t=>t.json()).then(t=>{this._updateStore(t)}),this.dataTypes.pipe(g(t=>t.find(r=>r.key===e)||null))}getAll(){const e=ct.getAll();return this._dataTypes.next(e),this.dataTypes}async save(e){try{const t=await(await fetch("/umbraco/backoffice/data-type/save",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json();this._updateStore(t)}catch(t){console.error("Save Data Type error",t)}}_updateStore(e){const t=this._dataTypes.getValue(),r=[...t];e.forEach(i=>{const o=t.map(a=>a.id).indexOf(i.id);o!==-1?r[o]=i:r.push(i)}),this._dataTypes.next([...r])}}const lt=[{id:99,key:"d81c7957-153c-4b5a-aa6f-b434a4964624",name:"Document Type 1",alias:"documentType1",properties:[]},{id:100,key:"a99e4018-3ffc-486b-aa76-eecea9593d17",name:"Document Type 2",alias:"documentType2",properties:[]}];class pt extends I{constructor(){super(lt)}}const dt=new pt;class ft{constructor(){this._documentTypes=new A([]),this.documentTypes=this._documentTypes.asObservable()}getById(e){return fetch(`/umbraco/backoffice/document-type/${e}`).then(t=>t.json()).then(t=>{this._updateStore(t)}),this.documentTypes.pipe(g(t=>t.find(r=>r.id===e)||null))}getAll(){const e=dt.getAll();return this._documentTypes.next(e),this.documentTypes}async save(e){try{const t=await(await fetch("/umbraco/backoffice/document-type/save",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json();this._updateStore(t)}catch(t){console.error("Save Document Type error",t)}}_updateStore(e){const t=this._documentTypes.getValue(),r=[...t];e.forEach(i=>{const o=t.map(a=>a.id).indexOf(i.id);o!==-1?r[o]=i:r.push(i)}),this._documentTypes.next([...r])}}const ht=[{id:1,key:"74e4008a-ea4f-4793-b924-15e02fd380d1",name:"Document 1",type:"document",icon:"document",properties:[{alias:"myHeadline",label:"Headline",description:"Text string property",dataTypeKey:"dt-1"},{alias:"myDescription",label:"Description",description:"Textarea property",dataTypeKey:"dt-2"}],data:[{alias:"myHeadline",value:"The daily life at Umbraco HQ"},{alias:"myDescription",value:"Every day, a rabbit in a military costume greets me at the front door"}],variants:[{name:"fake data"}]},{id:2,key:"74e4008a-ea4f-4793-b924-15e02fd380d2",name:"Document 2",type:"document",icon:"favorite",properties:[{alias:"myHeadline",label:"Text string label",description:"this is a text string property",dataTypeKey:"dt-1"},{alias:"myDescription",label:"Textarea label",description:"This is the a textarea property",dataTypeKey:"dt-2"},{alias:"myExternalEditor",label:"My JS Property Editor",description:"This is the a external property",dataTypeKey:"dt-3"},{alias:"myContextExampleEditor",label:"Context example label",description:"This is the a example property",dataTypeKey:"dt-4"},{alias:"myContentPicker",label:"Content Picker",description:"This is a content picker",dataTypeKey:"dt-5"}],data:[{alias:"myHeadline",value:"Is it all just fun and curling and scary rabbits?"},{alias:"myDescription",value:"So no, there's not confetti every day. And no, there's not champagne every week or a crazy rabbit running around \u{1F430}"},{alias:"myExternalEditor",value:"Tex lkasdfkljdfsa 1"},{alias:"myContextExampleEditor",value:""},{alias:"myContentPicker",value:""}],variants:[{name:"Variant 1"}]},{id:3,key:"cdd30288-2d1c-41b4-89a9-61647b4a10d5",name:"Document 3",type:"document",icon:"document",properties:[{alias:"myDescription",label:"Description",description:"Textarea property",dataTypeKey:"dt-2"}],data:[{alias:"myDescription",value:"Every day, a rabbit in a military costume greets me at the front door"}],variants:[{name:"Variant 1"}]},{id:2001,key:"f2f81a40-c989-4b6b-84e2-057cecd3adc1",name:"Media 1",type:"media",icon:"picture",properties:[{alias:"myMediaHeadline",label:"Media Headline",description:"Text string property",dataTypeKey:"dt-1"}],data:[{alias:"myMediaHeadline",value:"The daily life at Umbraco HQ"}],variants:[]},{id:2002,key:"69431027-8867-45bf-a93b-72bbdabfb177",type:"media",name:"Media 2",icon:"picture",properties:[{alias:"myMediaDescription",label:"Description",description:"Textarea property",dataTypeKey:"dt-2"}],data:[{alias:"myMediaDescription",value:"Every day, a rabbit in a military costume greets me at the front door"}],variants:[]}];class yt extends I{constructor(){super(ht)}}const bt=new yt;class vt{constructor(){this._nodes=new A([]),this.nodes=this._nodes.asObservable()}getById(e){return fetch(`/umbraco/backoffice/content/${e}`).then(t=>t.json()).then(t=>{this._updateStore(t)}),this.nodes.pipe(g(t=>t.find(r=>r.id===e)||null))}getAll(){const e=bt.getAll();return this._nodes.next(e),this.nodes}save(e){let t;try{t=JSON.stringify(e)}catch(r){return console.error(r),Promise.reject()}return fetch("/umbraco/backoffice/content/save",{method:"POST",body:t,headers:{"Content-Type":"application/json"}}).then(r=>r.json()).then(r=>{this._updateStore(r)})}_updateStore(e){const t=this._nodes.getValue(),r=[...t];e.forEach(i=>{const o=t.map(a=>a.id).indexOf(i.id);o!==-1?r[o]=i:r.push(i)}),this._nodes.next([...r])}}export{ut as UmbDataTypeStore,ft as UmbDocumentTypeStore,vt as UmbNodeStore};
